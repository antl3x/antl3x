---
schema: private_tables
table: Customer
---

rlsEnabled: true

policies:
  - name: select_policy_2
    for: SELECT
    to:
      - group:customer
    as: PERMISSIVE
    exprUsing: "true"
    exprWithCheck: null

  - name: select_policy
    for: ALL
    to:
      - customer:xyz
    as: PERMISSIVE
    exprUsing: "false"
    exprWithCheck: |-
      (
        (
          current_setting('app.user_role'::text) = 'admin'::text
        )
        OR (
          (
            current_setting('app.user_role'::text) = 'user'::text
          )
          AND ("CustomerId" = 123)
          AND (("Company")::text = 'Some Co Name'::text)
        )
      )
