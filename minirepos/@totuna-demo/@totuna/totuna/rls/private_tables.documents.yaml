---
schema: private_tables
table: documents
---
rlsEnabled: true

policies:
  - name: select_policy
    for: SELECT
    to:
      - customer:xyz
      - group:customer
    as: PERMISSIVE
    exprUsing: |-
      (
        (
          current_setting('app.user_role'::text) = 'admin'::text
        )
        OR (
          (
            current_setting('app.user_role'::text) = 'user'::text
          )
          AND (data ? 'name'::text)
        )
      )
    exprWithCheck: null

  - name: select_policy_3
    for: INSERT
    to:
      - customer:xyz
      - public
    as: PERMISSIVE
    exprUsing: null
    exprWithCheck: "true"

  - name: select_policy_5
    for: ALL
    to:
      - customer:xyz
    as: PERMISSIVE
    exprUsing: |-
      (
        (
          current_setting('app.user_role'::text) = 'admin'::text
        )
        OR (
          (
            current_setting('app.user_role'::text) = 'user'::text
          )
          AND (data ? 'name'::text)
        )
      )
    exprWithCheck: null
